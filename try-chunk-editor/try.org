#+TITLE: The Chunk Editor
# #+OPTIONS: toc:nil
# #+OPTIONS: num:nil
#+OPTIONS: html-postamble:nil
* Introduction
  Chunk editing is a new way to interact with Pyret programs. Statements are
  grouped into "chunks" that can be rearranged and linted independently. The
  right hand side displays bindings and test results from each chunk.

  [[file:overview.png]] 
  Chunks on the left, values on the right. The user is dragging a chunk using
  the mouse.
* Things to Try
** <<simple>>Create a simple chunk
   Identifiers and the values they are bound to are displayed on the right hand
   side of the page.
   1) Write ~x = 404 * 5~ in an empty chunk.
   2) Press =Enter= to update the right hand side.

   [[file:bind-id-to-val.png]] 
** <<multi-line>>Create a multi-line chunk
   Chunks are not limited to one line of code. Pressing =Enter= will advance you
   to the next chunk only if the one you're editing is syntactically complete.

   1) Write ~fun timesTwo(n :: Number) -> Number:~ in an empty chunk.
   2) Press =Enter= to move to the next line in the chunk.
   3) Write ~n * 2~ on the new line.
   4) Press =Enter=.
   5) Write ~end~ to complete the function definition.
   6) Press =Enter= to complete the chunk.

   [[file:multi-line-function.png]] 

   The chunk editor knows when you aren't finished with a statement. It will
   keep you in the same chunk until you complete it.
** Create new chunks with =Enter=
   Pressing =Enter= does different things depending on where your cursor is. If
   the cursor is at the end of a valid statement, =Enter= will create a new
   chunk and focus it (see [[simple]]). If the cursor is in the middle of a
   statement, =Enter= will create a new line in the same chunk (see [[multi-line]]).
** Move between chunks with the arrow keys
   Pressing =Up Arrow= while at the top of a chunk makes the cursor focus
   the chunk above. Similarly, pressing =Down Arrow= while at the bottom focuses
   the chunk below. This won't create any new chunks if they don't exist yet.
** Delete an empty chunk
   Using =Backspace= on an empty chunk will remove it, moving the cursor's focus
   into the chunk above.
** Fix an error
   Chunks with errors[fn:1] are highlighted red. Pressing =Enter= will make them
   jiggle and won't allow you to move into the next chunk.
   
   1) Write ~x = 12~ in another chunk to introduce a re-declaration error.
   2) Press =Enter= to display the error.
   3) Change ~x~ to ~y~ to fix the error.
   4) Press ~Enter~ to complete the chunk.
   
   [[file:errors.png]] 
* Things that don't entirely work yet
** <<type-check-off>>Tables
   Most table syntax and functions work, but only with type-checking turned off
   (it's on by default).
   [[file:table.png]] 
** Error messages[fn:1]
   Errors aren't rendered very intelligently. They contain source location
   information embedded directly in the text. We're still trying to figure out
   the best way to render these.
** Right hand side value rendering
   Everything can be displayed on the right hand side, but some of it doesn't
   look very pretty.

   The following list of items are rendered nicely:
   - Images
   - Tables (see [[type-check-off]])
   - Small integers
   - Strings
   
   The following list of items could be displayed better:
   - Abstract data types
   - Large integers / non-integer numbers
   - Functions
   - Test results
* Footnotes
[fn:1] Only compile and lint errors are currently displayed next to the
offending chunk(s). Runtime errors are displayed in a separate window.
